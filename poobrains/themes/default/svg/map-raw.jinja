<?xml version="1.0" encoding="UTF-8"?>

<svg xmlns:osb='http://www.openswatchbook.org/uri/2009/osb' xmlns:rdf='http://www.w3.org/1999/02/22-rdf-syntax-ns#' xml:space='preserve' xmlns:cc='http://creativecommons.org/ns#' viewBox='0 0 620 618' width="620" height="618" version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:dc='http://purl.org/dc/elements/1.1/'>
    <metadata>
        <rdf:RDF>
            <cc:Work rdf:about=''>
                <dc:format>image/svg+html</dc:format>
                <dc:type rdf:resource='http://purl.org/dc/dcmitype/InteractiveResource' />
                <dc:title />
            </cc:Work>
        </rdf:RDF>
    </metadata>

    <style>
        {{ content.style }}
    </style>

    <g class="map">
        <rect class="ocean" x="0" y="0" width="100%" height="100%" />
        {% include 'world.jinja' %}
    </g> <!-- / .map -->

    {% for dataset in content.datasets %}
    <g class="map-dataset">
        {% for datapoint in dataset.authorized_datapoints %} 
        <g class="map-datapoint">
            <circle class="marker" cx="{{ datapoint.x }}%" cy="{{ datapoint.y }}%" r="3px" />
            <switch> <!-- switch uses first item with supported (or no) requiredExtensions -->
                <foreignObject class="infobox html" requiredExtensions="http://www.w3.org/1999/xhtml" x="{{ datapoint.x }}%" y="{{ datapoint.y }}%" width="200" height="200"> <!-- either render HTML -->
                    <body xmlns="http://www.w3.org/1999/xhtml">
                        <h1>{{ datapoint.title }}</h1>
                        <div class="description">{{ datapoint.description.render() }}</div>
                        <div class="footer">
                            {{ datapoint.latitude }} / {{ datapoint.longitude }}
                        </div>
                    </body>
                </foreignObject>
                
                <text class="infobox" x="{{ datapoint.x }}%" y="{{ datapoint.y }}%">{{ datapoint.title }} @{{ datapoint.latitude }}, {{ datapoint.longitude }}</text> <!-- or fall back to "dumb" text -->
            </switch>

        </g>
        {% endfor %}
    </g>
    {% endfor %}
</svg>


